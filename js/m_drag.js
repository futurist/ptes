!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof module&&module.exports?module.exports=t():e.m_drag=t()}(this,function(){var e={revertOnFail:!0},t="ontouchstart"in window||"DocumentTouch"in window&&document instanceof DocumentTouch,n=t?"touchmove":"mousemove",o=t?"touchend":"mouseup";return function(t){function u(e){return function(t){var n=/touch/.test(t.type)?t.touches[0]:t,o=d[e];o&&(o.target=this,o.ox=n.ox||n.pageX,o.oy=n.oy||n.pageY,o.user.onmousedown&&o.user.onmousedown.call(this,t,o,d)===!1||(o.type=t.type))}}function r(e){var n=/touch/.test(e.type)?e.touches[0]:e,o=!1;for(var u in d){var r=d[u];if(r.type){o=!0;var a=[r.pageX,r.pageY,r.dx,r.dy];if(r.pageX=n.pageX,r.pageY=n.pageY,r.dx=r.ox-n.pageX,r.dy=r.oy-n.pageY,r.move&&r.move(e,r,d)===!1)return t.revertOnFail&&(r.dy=a.pop(),r.dx=a.pop(),r.pageY=a.pop(),r.pageX=a.pop()),p(e)}}o&&e.preventDefault()}function p(e){for(var t in d){var n=d[t];n.type&&(n.up&&n.up(e,n,d),n.type=null,n.dx=n.dy=0)}}function a(e,t,n,o){return 0===arguments.length?d:1===arguments.length?d[e]:("function"==typeof t&&(o=n,n=t,t={}),delete d[e],d[e]={name:e,user:t||{},move:n,up:o},u(e))}t=t||{};for(var i in e)i in t||(t[i]=e[i]);var d={};return document.addEventListener(n,r),document.addEventListener(o,p),a.destroy=function(){d={},document.removeEventListener(n,r),document.removeEventListener(o,p)},a}});